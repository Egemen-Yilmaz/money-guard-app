import{e as u,j as e,u as f,n as $,o as D,t as w,i as L,k as B,b as S,d as g,p as O,q as M}from"./index-Bi8L1Rv0.js";import{c as A,D as W,a as F,T as R}from"./index-Dfk1agOO.js";import{u as q,o as z,C as P,c as V,a as H,d as U,e as X}from"./index.esm-C34Lp5sr.js";const G="_tr_k8xj9_2",J="_income_k8xj9_17",K="_expense_k8xj9_22",Q="_td_k8xj9_26",Y="_mobileLabel_k8xj9_44",Z="_date_k8xj9_59",ee="_type_k8xj9_64",te="_comment_k8xj9_68",se="_sum_k8xj9_76",ne="_typeIncome_k8xj9_81",ae="_sumIncome_k8xj9_85",oe="_typeExpense_k8xj9_89",ce="_sumExpense_k8xj9_93",re="_actions_k8xj9_97",ie="_iconButton_k8xj9_110",le="_deleteButton_k8xj9_126",de="_actionsCell_k8xj9_164",s={tr:G,income:J,expense:K,td:Q,mobileLabel:Y,date:Z,type:ee,comment:te,sum:se,typeIncome:ne,sumIncome:ae,typeExpense:oe,sumExpense:ce,actions:re,iconButton:ie,deleteButton:le,actionsCell:de},me=({transaction:t,onDelete:o,onEdit:c})=>{const d=u(_=>_.transactions?.categories||[]),p=()=>{typeof c=="function"&&c(t)},h=()=>{typeof o=="function"&&window.confirm("Bu işlemi kalıcı olarak silmek istediğinize emin misiniz?")&&o(t.id||t._id)},m=t.categoryId||t.category?.id,x=d.find(_=>_.id===m)||d.find(_=>_.name===t.category),b=x?x.name:t.category||"-",l=t.transactionDate?new Date(t.transactionDate).toLocaleDateString("tr-TR"):t.date||"-",r=t.type?.toLowerCase()||"",N=t.amount??t.sum??0,y=Math.abs(N).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2});return e.jsxs("tr",{className:`${s.tr} ${r==="income"?s.income:s.expense}`,children:[e.jsxs("td",{className:`${s.td} ${s.date}`,children:[e.jsx("span",{className:s.mobileLabel,children:"Date:"}),l]}),e.jsxs("td",{className:`${s.td} ${s.type} ${r==="income"?s.typeIncome:s.typeExpense}`,children:[e.jsx("span",{className:s.mobileLabel,children:"Type:"}),r==="income"?"+":"-"]}),e.jsxs("td",{className:s.td,children:[e.jsx("span",{className:s.mobileLabel,children:"Category:"}),r==="expense"?b:"Income"]}),e.jsxs("td",{className:`${s.td} ${s.comment}`,children:[e.jsx("span",{className:s.mobileLabel,children:"Comment:"}),t.comment||"-"]}),e.jsxs("td",{className:`${s.td} ${s.sum} ${r==="income"?s.sumIncome:s.sumExpense}`,children:[e.jsx("span",{className:s.mobileLabel,children:"Amount:"}),e.jsx("div",{className:s.amountContent}),y]}),e.jsxs("td",{className:`${s.td} ${s.actionsCell}`,children:[e.jsx("span",{className:s.mobileLabel,children:"Actions:"}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.iconButton,onClick:p,children:e.jsx(A,{size:16})}),e.jsx("button",{className:s.deleteButton,onClick:h,children:"Delete"})]})]})]})},_e="_noTransactionsContainer_xcdh7_1",ue="_inactive_xcdh7_19",pe="_inner_xcdh7_23",he="_title_xcdh7_30",xe="_subtitle_xcdh7_39",be="_addButton_xcdh7_48",j={noTransactionsContainer:_e,inactive:ue,inner:pe,title:he,subtitle:xe,addButton:be},je=()=>{const t=f(),o=u(c=>c.transactions?.isModalOpen||!1);return e.jsx("section",{className:`${j.noTransactionsContainer} ${o?j.inactive:""}`,"aria-live":"polite",children:e.jsxs("div",{className:j.inner,children:[e.jsx("h3",{className:j.title,"aria-hidden":o,children:"No transactions available yet."}),e.jsx("p",{className:j.subtitle,"aria-hidden":o,children:"Let's add your first transaction:"}),e.jsx("button",{type:"button",onClick:()=>t($()),className:`form-button ${j.addButton}`,"aria-hidden":o,children:"ADD TRANSACTION"})]})})},Ne="_container_1krnb_1",ye="_title_1krnb_8",ge="_typeIndicator_1krnb_15",fe="_activeLabelIncome_1krnb_23",ke="_activeLabelExpense_1krnb_28",ve="_inactiveLabel_1krnb_33",Ie="_separator_1krnb_38",Ce="_form_1krnb_42",Le="_row_1krnb_49",Ee="_field_1krnb_62",Te="_input_1krnb_67",$e="_amountInput_1krnb_82",De="_dateInput_1krnb_92",we="_error_1krnb_96",Be="_dateWrapper_1krnb_104",Se="_calendarIcon_1krnb_109",Oe="_actions_1krnb_119",Me="_submitButton_1krnb_127",Ae="_cancelButton_1krnb_145",n={container:Ne,title:ye,typeIndicator:ge,activeLabelIncome:fe,activeLabelExpense:ke,inactiveLabel:ve,separator:Ie,form:Ce,row:Le,field:Ee,input:Te,amountInput:$e,dateInput:De,error:we,dateWrapper:Be,calendarIcon:Se,actions:Oe,submitButton:Me,cancelButton:Ae},We=V().shape({amount:X().transform(t=>Number.isNaN(t)?null:t).nullable().required("Amount is required").positive("Must be positive"),date:U().required("Date is required"),comment:H().required("Comment is required")}),Fe=({transaction:t,onClose:o})=>{const c=f(),{register:d,handleSubmit:p,control:h,formState:{errors:m}}=q({resolver:z(We),defaultValues:{amount:t?.amount!==void 0?Math.abs(t.amount):"",date:t?.transactionDate?new Date(t.transactionDate):t?.date?new Date(t.date):new Date,comment:t?.comment||""}}),x=async l=>{try{const r=t?.type&&t.type.toLowerCase()==="income",N=new Date(l.date.getTime()-l.date.getTimezoneOffset()*6e4).toISOString().split("T")[0],y={id:t.id,transactionDate:N,type:r?"INCOME":"EXPENSE",categoryId:t.categoryId||t.category?.id||"063f1132-ba5d-42b4-951d-44011ca46262",comment:l.comment,amount:r?Math.abs(l.amount):-Math.abs(l.amount)};await c(D(y)).unwrap(),w("Transaction updated successfully!"),c(L()),c(B()),o()}catch(r){console.error("Failed to update transaction:",r),S(r?.message||"Error updating transaction")}},b=t?.type&&t.type.toLowerCase()==="income";return e.jsxs("div",{className:n.container,children:[e.jsx("h2",{className:n.title,children:"Edit transaction"}),e.jsxs("div",{className:n.typeIndicator,children:[e.jsx("span",{className:b?n.activeLabelIncome:n.inactiveLabel,children:"Income"}),e.jsx("span",{className:n.separator,children:" / "}),e.jsx("span",{className:b?n.inactiveLabel:n.activeLabelExpense,children:"Expense"})]}),e.jsxs("form",{onSubmit:p(x),className:n.form,children:[e.jsxs("div",{className:n.row,children:[e.jsxs("div",{className:n.field,children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",...d("amount"),className:`${n.input} ${n.amountInput}`}),m.amount&&e.jsx("span",{className:n.error,children:m.amount.message})]}),e.jsxs("div",{className:n.field,children:[e.jsx(P,{control:h,name:"date",render:({field:l})=>e.jsxs("div",{className:n.dateWrapper,children:[e.jsx(W,{selected:l.value,onChange:r=>l.onChange(r),dateFormat:"dd.MM.yyyy",className:`${n.input} ${n.dateInput}`}),e.jsx(F,{className:n.calendarIcon})]})}),m.date&&e.jsx("span",{className:n.error,children:m.date.message})]})]}),e.jsxs("div",{className:n.field,children:[e.jsx("input",{type:"text",placeholder:"Comment",...d("comment"),className:n.input}),m.comment&&e.jsx("span",{className:n.error,children:m.comment.message})]}),e.jsxs("div",{className:n.actions,children:[e.jsx("button",{type:"submit",className:n.submitButton,children:"SAVE"}),e.jsx("button",{type:"button",onClick:o,className:n.cancelButton,children:"CANCEL"})]})]})]})},Re=({isOpen:t,onClose:o,transaction:c})=>t?e.jsx(R,{onClose:o,children:e.jsx(Fe,{transaction:c,onClose:o})}):null,qe="_tableWrapper_iepd2_15",ze="_tableOverlay_iepd2_24",Pe="_table_iepd2_15",Ve="_theadRow_iepd2_48",He="_th_iepd2_48",Ue="_error_iepd2_89",i={tableWrapper:qe,tableOverlay:ze,table:Pe,theadRow:Ve,th:He,error:Ue},Xe=()=>{const[t,o]=g.useState("desc"),[c,d]=g.useState(!1),[p,h]=g.useState(null),m=f(),x=u(a=>a.transactions?.items||[]),b=u(a=>a.transactions?.loading||!1),l=u(a=>a.transactions?.error||null);if(l)return e.jsxs("div",{className:i.error,children:["Error loading transactions: ",l]});if(b)return e.jsx("div",{className:i.tableWrapper,children:e.jsx("div",{className:i.tableOverlay,children:e.jsx("div",{className:i.loadingText,children:"Loading transactions..."})})});const r=[...x].sort((a,v)=>{const I=new Date(a.transactionDate||a.date||0),C=new Date(v.transactionDate||v.date||0);return t==="asc"?I-C:C-I}),N=()=>{o(a=>a==="asc"?"desc":"asc")},y=a=>{window.confirm("Are you sure you want to permanently delete this transaction?")&&m(O(a))},_=a=>{h(a),d(!0)},E=()=>{h(null),d(!1)},T=()=>{N()};return r.length===0?e.jsx(je,{}):e.jsxs("div",{className:i.tableContainer,children:[c&&p&&e.jsx(Re,{isOpen:c,onClose:E,transaction:p}),e.jsx("div",{className:i.tableWrapper,children:e.jsxs("table",{className:i.table,children:[e.jsx("thead",{children:e.jsxs("tr",{className:i.theadRow,children:[e.jsxs("th",{className:i.th,onClick:T,style:{cursor:"pointer"},children:["Date",e.jsx("span",{className:i.sortIcon,children:t==="asc"?"▲":"▼"})]}),e.jsx("th",{className:i.th,children:"Type"}),e.jsx("th",{className:i.th,children:"Category"}),e.jsx("th",{className:i.th,children:"Comment"}),e.jsx("th",{className:i.th,children:"Amount"}),e.jsx("th",{className:i.th,children:"Actions"})]})}),e.jsx("tbody",{children:r.map(a=>e.jsx(me,{transaction:a,onDelete:()=>y(a.id||a._id),onEdit:()=>_(a)},a.id||a._id))})]})})]})},Ge="_homeTab_1gs7g_1",Je="_loading_1gs7g_7",Ke="_error_1gs7g_14",k={homeTab:Ge,loading:Je,error:Ke},et=()=>{const t=f(),o=u(d=>d.transactions?.isLoading??!1),c=u(d=>d.transactions?.error??null);return g.useEffect(()=>{t(L()),t(M())},[t]),e.jsxs("div",{className:k.homeTab,children:[o&&e.jsx("div",{className:k.loading,children:"Loading transactions..."}),c&&e.jsxs("div",{className:k.error,children:["Error: ",c]}),!o&&!c&&e.jsx(Xe,{})]})};export{et as default};
